{% extends 'admin_dashboard/base.html' %}

{% block content %}
<div class="container mt-4">
    <div class="form-container">
        <h2 class="text-center page-title">Add Subunit / Recharge Unit to {{ unit.name }}</h2>

        <form method="post">
            {% csrf_token %}

            <!-- Subunit Section -->
            <div id="subunit-container">
                <div class="section-title">Subunits</div>
                <button type="button" class="btn btn-success btn-sm mb-2" onclick="addSubunitField()">+ Add Subunit</button>
                <div id="subunit-fields"></div>
            </div>

            <!-- Recharge Unit Section -->
            <div id="recharge-container" class="mt-4">
                <div class="section-title">Recharge Units</div>
                <button type="button" class="btn btn-success btn-sm mb-2" onclick="addRechargeField()">+ Add Recharge Unit</button>
                <div id="recharge-fields"></div>
            </div>

            <!-- Buttons in the Same Row -->
            <div class="save-btn-container">
                <a href="{% url 'unit_detail' unit.id %}" class="btn btn-secondary">Back</a>
                <button type="submit" class="btn btn-primary">Save</button>
            </div>
    </div>
</div>

<script>
function addSubunitField() {
    let subunitFields = document.getElementById("subunit-fields");
    let div = document.createElement("div");
    div.className = "input-group mb-2";
    
    let input = document.createElement("input");
    input.type = "text";
    input.name = "subunits[]";
    input.className = "form-control";
    input.placeholder = "Enter Subunit Name";

    let removeButton = document.createElement("button");
    removeButton.className = "btn btn-danger";
    removeButton.innerHTML = "Remove";
    removeButton.type = "button";
    removeButton.onclick = function() {
        subunitFields.removeChild(div);
    };

    div.appendChild(input);
    div.appendChild(removeButton);
    subunitFields.appendChild(div);
}

function addRechargeField() {
    let rechargeFields = document.getElementById("recharge-fields");
    let div = document.createElement("div");
    div.className = "input-group mb-2";
    
    let input = document.createElement("input");
    input.type = "text";
    input.name = "recharge_units[]";
    input.className = "form-control";
    input.placeholder = "Enter Recharge Unit Name";

    let removeButton = document.createElement("button");
    removeButton.className = "btn btn-danger";
    removeButton.innerHTML = "Remove";
    removeButton.type = "button";
    removeButton.onclick = function() {
        rechargeFields.removeChild(div);
    };

    div.appendChild(input);
    div.appendChild(removeButton);
    rechargeFields.appendChild(div);
}
</script>

{% endblock %}
